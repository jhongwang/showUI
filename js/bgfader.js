function bgfader(t,n){var i={speed:3e3,timeout:3e3,opacity:.5};t=t&&t.length?t:[];var r=!0,a=null,o=!1,e=$(this),s={},u=$("<div>",{id:"bgfader_imageset_"+$(".bgfader").length,class:"bgfader"});u.data("no",$(".bgfader").length);var d=$("<div>",{class:"bgfader-overlay"});i=$.extend({},i,n);var c=function(n){if(void 0!==n.data("loading-image"))return n;if(g(n))return n;n.data("loading-image",!0);var e=l(n);return-1===e||$("<img>").attr("src",t[e]).load(function(){n.css("background-image","url("+t[e]+")"),n.data("loading-image",!1),$(this).remove()}),n},g=function(n){return!0===n.data("loading-image")},f=function(n){return"none"!==n.css("background-image")},l=function(n){return $(".image").index(n)},m=function(){return u.find(".image:visible")},v=function(n){return n.next().length?h(n.next()):b(),this},p=function(n){return n.prev().length?h(n.prev()):h(u.find(".image:last")),this},h=function(t){o||(m().hide(),o=!0,(t=c(t)).fadeIn(i.speed,function(){var n;f(t)&&(n=t,u.css("background-image",n.css("background-image")));var e=t.next();f(e)||c(e),o=!1,r&&(a=setTimeout(function(){v(t)},i.timeout))}))},b=function(){return r=!0,h(u.find(".image:first")),this},x=function(){return r=!1,clearTimeout(a),this};return s={position:e.css("position"),"z-index":e.css("z-index")},e.css({position:"relative","z-index":0}),d.css("background","rgba(0, 0, 0, "+i.opacity+")"),e.append(u).append(d),u.show(),$.each(t,function(n,e){var t=$("<div>",{class:"image"});u.append(t)}),{next:function(){return x(),v(m()),this},prev:function(){return x(),p(m()),this},start:b,stop:x,destroy:function(){return x(),d.remove(),u.remove(),e.css(s),null}}}jQuery.fn.extend({bgfader:bgfader});